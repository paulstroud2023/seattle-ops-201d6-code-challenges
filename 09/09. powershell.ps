#!/bin/bash

# Script: Ops 201 Class 07 Ops Challenge Solution
# Author: Paul Stroud
# Date of latest revision: 02/16/23
# Purpose: Log Retrieval via Powershell
#
# Resources used: google

# Main

echo "*** Le Compooter ***"


# Output all events from the System event log that occurred in the last 24 hours to a file on your desktop named last_24.txt.


# Output all "error" type events from the System event log to a file on your desktop named errors.txt.


# Print to the screen all events with ID of 16 from the System event log.
echo "> System log events with EventID 16..."
Get-EventLog -LogName System | Where-Object -Property EventID -eq 16 


# Print to the screen the most recent 20 entries from the System event log.'
echo "> 20 most recent System log events..."
Get-EventLog -LogName system -Newest 20 | Select-Object -ExpandProperty source

# Print to the screen all sources of the 500 most recent entries in the System event log
echo "> The Source field for the 500 most recent System log events..."
Get-EventLog -LogName system -Newest 500 | Select-Object -ExpandProperty source

# check for root access
if (( $(id -u) == 0 ))  # UID == 0 is root
  then echo "Root access check: OK"
  else  # exit the script
        echo "Root access check: FAILED"
        echo "Please re-run this script as sudo/root"
        exit
fi


echo -e "\n*** Mission complete! ***\n"
# End
